
dat <- read.csv(textConnection("
top,id_date,top10_sum,share
top30,2010,190302568.04000,0.47546952198062469983
top30,2011,222154686.07000,0.48577958480512647736
top30,2012,238442142.33000,0.49671081548000405985
top30,2013,260835017.31000,0.51267875146581591504
top30,2014,286652063.50000,0.51411561221511450234
top30,2015,316641820.33000,0.51276233900454996724
top20,2010,171155361.89000,0.42763037272914738156
top20,2011,201148595.81000,0.43984614092689799731
top20,2012,214494262.70000,0.44682378333125093681
top20,2013,233445507.17000,0.45884387911373945117
top20,2014,256262464.15000,0.45961132124985063031
top20,2015,283800000.16000,0.45957906551911608934
top3,2010,106823523.19000,0.26689776197218508831
top3,2011,129596303.30000,0.28338469704625683010
top3,2012,141072310.44000,0.29387482294686817053
top3,2013,156604706.36000,0.30781106830795686369
top3,2014,172697772.43000,0.30973654930984291529
top3,2015,189991499.92000,0.30766777991748405376
top1,2010,88805662.39000,0.22188027350671815567
top1,2011,108708265.91000,0.23770939615473799596
top1,2012,117182981.43000,0.24410976053854293636
top1,2013,127364965.33000,0.25033951376346865817
top1,2014,136189516.87000,0.24425833879580885900
top1,2015,144082857.97000,0.23332440164145251429
top10,2010,141833286.76000,0.35436939055148898777
top10,2011,168168466.37000,0.36772939259445743823
top10,2012,180175477.64000,0.37533259663555564127
top10,2013,198260713.91000,0.38968715289978532628
top10,2014,218410650.40000,0.39172341504772507304
top10,2015,242586246.83000,0.39283847978529556365
"), header =T)

head(dat)

require(ggplot2)
Sys.setlocale("LC_MESSAGES", 'pl_PL.UTF-8')
Sys.setlocale(category = "LC_ALL", locale = "pl_PL.utf-8")

dat$top <- factor(dat$top, 
                  levels=c('top30','top20','top10','top3','top1'), 
                  labels = c('30 największych beneficjentów', '20 największych benficjentów', '10 największych beneficjentów', '3 największych beneficjentów', 'największy beneficjent'))

require(directlabels)

ggplot(dat, aes(x = id_date, y = share, color = top)) + 
  geom_line(stat="identity", size = 1) +
  geom_text(data = subset(dat, dat$id_date == 2015), aes(label = top), size = 4, hjust = -.05) +
    scale_y_continuous('procent wszystkich darowizn na rzecz "1%"', labels = scales::percent) +
  scale_x_continuous("", breaks = unique(dat$id_date), limits = c(min(dat$id_date), max(dat$id_date) + 3) ) +
  ggtitle('Udział największych beneficjentów darowizn z "1%"\n') + 
  theme_light() + theme(legend.position = 'none') +
  scale_color_manual(values = c('#ff976d','#f47461','#e25056','#cb2f44','#ae112a','#8b0000'))

