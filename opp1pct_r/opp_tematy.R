
dat <- read.csv(textConnection("
theme,id_date,amount,pit,pct_opp,pct_pit
disabled,2010,25481570.82000,62487000000,0.06366551130594419779,0.00040778995343031351
disabled,2011,33204208.00000,67505115000,0.07260673479982586361,0.00049187691925271144
disabled,2012,38772443.31000,70621939000,0.08076882612474021152,0.00054901414289970147
disabled,2013,44552920.05000,73751310000,0.08757004968486881256,0.00060409666011356273
disabled,2014,53857258.56000,78127386000,0.09659395825979154722,0.00068935185621082984
disabled,2015,64998732.11000,83140145000,0.10525742264341077220,0.00078179719448408467
hospice,2010,31531483.23000,62487000000,0.07878117154760064639,0.00050460869028757982
hospice,2011,33884155.12000,67505115000,0.07409355659722411423,0.00050194944664563567
hospice,2012,32493096.60000,70621939000,0.06768800326965485072,0.00046009918532539867
hospice,2013,33747934.30000,73751310000,0.06633253847550421985,0.00045759098109579342
hospice,2014,36606817.35000,78127386000,0.06565498285046228351,0.00046855295209800057
hospice,2015,38777560.00000,83140145000,0.06279547138077582762,0.00046641198424659952
animals,2010,13617519.06000,62487000000,0.03402326802368381639,0.00021792563349176629
animals,2011,15882071.71000,67505115000,0.03472889245603409247,0.00023527212286061582
animals,2012,16090535.55000,70621939000,0.03351900363103274102,0.00022784046682717109
animals,2013,17097997.88000,73751310000,0.03360660810072720756,0.00023183314140453912
animals,2014,18893154.56000,78127386000,0.03388521123724330790,0.00024182499283925869
animals,2015,20512542.81000,83140145000,0.03321753083412917097,0.00024672248057782435
cancer,2010,11661325.03000,62487000000,0.02913573208591365254,0.00018662001744362827
cancer,2011,12008748.77000,67505115000,0.02625920296671810500,0.00017789390878009763
cancer,2012,13639786.53000,70621939000,0.02841372512461721456,0.00019313809169130856
cancer,2013,16015238.48000,73751310000,0.03147841326302972325,0.00021715191879303568
cancer,2014,18329474.28000,78127386000,0.03287424055485089888,0.00023461010560368678
cancer,2015,23750919.88000,83140145000,0.03846168272556704584,0.00028567330355269407
skauting,2010,2721867.29000,62487000000,0.00680056476693985440,0.000043558936898874965993
skauting,2011,2851249.98000,67505115000,0.00623475046132311897,0.000042237539777541301870
skauting,2012,2783475.36000,70621939000,0.00579839747464031214,0.000039413748750229018776
skauting,2013,2567480.66000,73751310000,0.00504645730759772660,0.000034812678717164481553
skauting,2014,2622809.60000,78127386000,0.00470405601398253874,0.000033570937596709046428
skauting,2015,3100326.15000,83140145000,0.00502059546870395934,0.000037290362555898838040
senior,2010,189893.87000,62487000000,0.00047444839302942540,0.000003038934018275801367
senior,2011,309213.35000,67505115000,0.00067614838757833750,0.000004580591411480448556
senior,2012,331977.46000,70621939000,0.00069155893864334594,0.000004700769544149729449
senior,2013,306881.88000,73751310000,0.00060318518850900658,0.000004161036325998819546
senior,2014,354697.54000,78127386000,0.00063615639357954618,0.000004539989857077772959
senior,2015,324872.78000,83140145000,0.00052609136208887516,0.000003907532035215959751
sport,2010,5374951.65000,62487000000,0.01342927590529045810,0.000086017117960535791445
sport,2011,5943772.57000,67505115000,0.01299708514958313142,0.000088049217751869617584
sport,2012,5892404.24000,70621939000,0.01227476354048841580,0.000083435888669100405187
sport,2013,6238902.04000,73751310000,0.01226274194842206290,0.000084593779283378152876
sport,2014,6752761.83000,78127386000,0.01211119934035746776,0.000086432711699838517572
sport,2015,6978028.60000,83140145000,0.01130005588916721979,0.000083930916887383345314
"), header =T)

head(dat)

require(ggplot2)
Sys.setlocale(category = "LC_ALL", locale = "pl_PL.utf-8")

dat$theme <- factor(dat$theme, 
                  levels=c('disabled', 'hospice', 'cancer', 'animals', 'sport', 'skauting', 'senior'), 
                  labels=c('niepeÅ‚nosprawni', 'hospicjum', 'rak', 'zwierzÄ™ta', 'sport', 'harcerstwo', 'starsi'))

dat$theme
require(directlabels)

require(Cairo)

#Cairo(file = "opp_tematy.png", type = "png", units = "in", width = 6, height = 4.5, pointsize = 8, dpi = 300)
#Cairo(file = "opp_tematy.png", type = "png", units = "px", width = 600, height = 400, dpi = 200)
#png(filename = "opp_tematy.png", width = 700, height = 700, unit="px", res=300, pointsize = 1)

ggplot(dat, aes(x = id_date, y = pct_opp, color = theme)) + 
  geom_line(size = 1) +
  geom_text(data = subset(dat, dat$id_date == 2015), aes(label = theme), size = 4, hjust = -.05) +
  scale_y_continuous('procent wszystkich darowizn na rzecz "1%"', labels = scales::percent) +
  scale_x_continuous("", breaks = unique(dat$id_date), limits = c(min(dat$id_date), max(dat$id_date) + 1.7) ) +
  ggtitle('Wybrane sÅ‚owa kluczewe z nazw\n') + 
  theme_light() + theme(legend.position = 'none', panel.grid.minor = element_blank())
#dev.off()
#ggsave("opp_tematy.png", units = "in", width = 4, height = 3, dpi =1200)

